    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Item Catalog</title>
        <%- include('sidebar') %>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <style>
            /* The Modal (background) */
            .modal {
                display: none; /* Hidden by default */
                position: fixed; /* Stay in place */
                z-index: 1; /* Sit on top */
                left: 0;
                top: 0;
                width: 100%; /* Full width */
                height: 100%; /* Full height */
                overflow: auto; /* Enable scroll if needed */
                background-color: rgb(0,0,0); /* Fallback color */
                background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            }

            /* Modal Content/Box */
            .modal-content {
                background-color: #fefefe;
                margin: 15% auto; /* 15% from the top and centered */
                padding: 20px;
                border: 1px solid #888;
                width: 80%; /* Could be more or less, depending on screen size */
            }

            /* The Close Button */
            .close {
                color: #aaa;
                float: right;
                font-size: 28px;
                font-weight: bold;
            }

            .close:hover,
            .close:focus {
                color: black;
                text-decoration: none;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <!-- Labels at the top -->
        <div style="display: flex; justify-content: space-between;">
            <h2>INVENTORY MANAGER</h2>
            <p id="currentDate"></p> <!-- Dynamic date will be inserted here -->
        </div>

        <!-- Category buttons -->
        <div>
            <button onclick="filterTable('')">All</button>
            <button onclick="filterTable(1)">Fabrication</button> <!-- Pass classification id as argument -->
            <button onclick="filterTable(2)">Fire Protection</button> <!-- Pass classification id as argument -->
            <button onclick="filterTable(3)">Electrical</button> <!-- Pass classification id as argument -->
        </div>

        <h1>Item Catalog</h1>
        
        <table id="itemTable">
            <thead>
                <tr>
                    <th>CODE</th>
                    <th>DESCRIPTION</th>
                    <th>ACTION</th>
                </tr>
            </thead>
            <tbody>
                <% if (cluster && cluster.length > 0) { %>
                    <% cluster.forEach(cluster => { %>
                        
                        <tr class="cluster-row" data-clustercode="<%= cluster.clustercode %>" data-classificationid="<%= cluster.classification_id %>">
                            <!-- Add data-clustercode attribute -->
                            <td><%= cluster.clustercode %></td>
                            <td><%= cluster.description %></td>
                            <td>
                                <button onclick="openModal('<%= cluster.clustercode %>')" style="font-family: FontAwesome;"></button>
                                <button onclick="documentFunction()" style="font-family: FontAwesome;"></button>
                            </td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="4">No items found</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <!-- The Modal -->
        <div id="myModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
                <span class="close">×</span>
                <p>Edit Cluster Information</p>
            <!-- Add your form or other elements here -->
            <table id="modalItemTable">
                <thead>
                    <tr>
                        <th>CODE</th>
                        <th>DESCRIPTION</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (item && item.length > 0) { %>
                        <% item.forEach(item => { %>
                            <tr class="item-row" data-clustercode="<%= item.clustercode %>"> <!-- Add data-clustercode attribute -->
                                <td><%= item.code %></td>
                                <td><%= item.material_name %></td>
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="2">No items found</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
            <button onclick="discardChanges()">Discard</button>
            <button onclick="saveChanges()">Save</button>
        </div>

    </div>

        <!-- Add button for adding a new item -->
        <button onclick="window.location.href='/add-item'">Add Item</button>

        <script>
           // Display the current date
document.getElementById('currentDate').textContent = new Date().toLocaleString();

// Filter the table based on classification id
// Filter the table based on classification id
function filterTable(id) {
    $('#itemTable tbody tr').each(function() {
        var rowId = $(this).attr('class');
        if (id === '' || id.toString() === rowId || id === $(this).data('classificationid')) {
            $(this).show();
        } else {
            $(this).hide();
        }
    });
}


// Get the modal
var modal = document.getElementById("myModal");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}

// Function to open the modal and filter items based on the clustercode
function openModal(clustercode) {
    // Filter the items based on the clustercode
    var items = $('#myModal tbody tr').filter(function() {
        return $(this).data('clustercode') === clustercode;
    });

    // Hide all items
    $('#myModal tbody tr').hide();

    // Show only the items with the same clustercode
    items.show();

    // Show the modal
    modal.style.display = "block";
}

// Functions to handle the discard and save buttons
function discardChanges() {
    // Add your code here to discard changes
}

function saveChanges() {
    // Add your code here to save changes
}

        </script>
    </body>
    </html>
